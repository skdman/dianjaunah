<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dianjaunah | Cart</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
body {font-family: 'Poppins', sans-serif; background: #fff0f5; color: #5a3e36; margin:0; padding:0;}
.container {width: 90%; max-width: 1000px; margin: auto; padding: 40px 0;}
h1 {text-align: center; margin-bottom: 30px;}
.cart-item {background: #fff; border: 1px solid #f2dede; border-radius: 8px; padding: 15px 20px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; flex-wrap:wrap;}
.cart-item span {font-weight: 500;}
.total {text-align: right; font-size: 18px; margin-top: 20px; font-weight: 600;}
.empty {text-align: center; color: #aaa;}
.add-cart-btn, .checkout-btn, .remove-btn, .qty-btn {display: inline-block; padding: 5px 10px; color: #fff; text-decoration: none; border-radius: 6px; font-weight: 600; cursor: pointer; border: none;}
.add-cart-btn {background: #e86b8a;}
.add-cart-btn:hover {background: #d35470;}
.checkout-btn {background: #4caf50; margin-left: 10px;}
.checkout-btn:hover {background: #3e8e41;}
.remove-btn {background: #f44336; margin-left: 10px;}
.remove-btn:hover {background: #d32f2f;}
.qty-btn {background: #555; margin: 0 3px;}
.qty-btn:hover {background: #333;}
.qty-container {display: flex; align-items: center;}
.item-actions {display: flex; align-items: center; gap: 10px;}
</style>
</head>
<body>
<div class="container">
<h1>Your Cart</h1>
<div id="cartItems"></div>
<p class="total" id="cartTotal"></p>
<div style="text-align:center; margin-top:30px;">
  <a href="product.html" class="add-cart-btn">← Continue Shopping</a>
  <button id="checkoutBtn" class="checkout-btn">Checkout</button>
</div>
</div>

<script>
// localStorage
let cart = JSON.parse(localStorage.getItem("cart")) || [];

const cartContainer = document.getElementById('cartItems');
const cartTotal = document.getElementById('cartTotal');
const checkoutBtn = document.getElementById('checkoutBtn');

// Render cart
function renderCart() {
  cartContainer.innerHTML = '';
  if(cart.length === 0){
    cartContainer.innerHTML = '<p class="empty">Your cart is empty</p>';
    cartTotal.textContent = '';
    checkoutBtn.style.display = 'none';
    return;
  }

  let total = 0;
  let html = '';

  cart.forEach((item, index) => {
    const subtotal = Number(item.price) * Number(item.qty);
    total += subtotal;
    html += `
      <div class="cart-item">
        <span>${item.name} (${item.color || 'No Color'})</span>
        <div class="qty-container">
          <button class="qty-btn" onclick="decreaseQty(${index})">−</button>
          <span style="margin:0 10px;">${item.qty}</span>
          <button class="qty-btn" onclick="increaseQty(${index})">+</button>
        </div>
        <div class="item-actions">
          <span>RM${subtotal.toFixed(2)}</span>
          <button class="remove-btn" onclick="removeItem(${index})">Remove</button>
        </div>
      </div>
    `;
  });

  cartContainer.innerHTML = html;
  cartTotal.textContent = `Total: RM${total.toFixed(2)}`;
  checkoutBtn.style.display = 'inline-block';
}

// Increase quantity
function increaseQty(index){
  cart[index].qty = Number(cart[index].qty) + 1;
  saveCart();
}

// Decrease quantity
function decreaseQty(index){
  if(cart[index].qty > 1){
    cart[index].qty = Number(cart[index].qty) - 1;
  } else {
    removeItem(index);
    return;
  }
  saveCart();
}

// Remove item
function removeItem(index){
  if(confirm(`Remove ${cart[index].name} from cart?`)){
    cart.splice(index,1);
    saveCart();
  }
}

// Save cart to localStorage & re-render
function saveCart(){
  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
}

// Checkout
checkoutBtn.addEventListener('click', ()=>{
  if(cart.length === 0) return alert("Your cart is empty!");
  const totalAmount = cart.reduce((sum,item)=>sum + Number(item.price)*Number(item.qty),0).toFixed(2);
  alert(`Thank you for your purchase! Total: RM${totalAmount}`);
  cart = [];
  localStorage.removeItem("cart");
  renderCart();
});

// Initial render
renderCart();
</script>
</body>
</html>